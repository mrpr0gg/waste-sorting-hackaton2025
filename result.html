<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞</title>

    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #f6d95c;
            font-family: "Inter", sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 {
            margin-top: 30px;
            font-size: 38px;
            font-weight: 700;
        }

        .card {
            margin-top: 30px;
            background: white;
            border-radius: 28px;
            padding: 30px;
            width: 85%;
            max-width: 650px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.25);
        }

        .row {
            margin-bottom: 18px;
            font-size: 24px;
        }

        .label {
            font-weight: 700;
            font-size: 26px;
        }

        .container-box {
            background: #eee;
            padding: 15px;
            border-radius: 18px;
            font-size: 24px;
            text-align: center;
            margin: 20px 0;
        }

        ul {
            font-size: 20px;
        }

        button {
            margin-top: 35px;
            padding: 15px 35px;
            font-size: 24px;
            border-radius: 40px;
            border: 2px solid black;
            background: white;
            cursor: pointer;
            transition: 0.2s;
        }

        button:hover {
            transform: scale(1.05);
        }

        .error {
            font-size: 26px;
            color: red;
            font-weight: bold;
            text-align: center;
            margin-top: 40px;
        }
    </style>
</head>

<body>

    <h1>–†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞</h1>

    <div id="errorBlock" class="error" style="display:none;"></div>

    <div id="resultCard" class="card" style="display:none;">
        
        <div class="row">
            <span class="label">–ü—Ä–µ–¥–º–µ—Ç:</span>
            <span id="objectText"></span>
        </div>

        <div class="row">
            <span class="label">–ú–∞—Ç–µ—Ä–∏–∞–ª:</span>
            <span id="materialText"></span>
        </div>

        <div id="containerBox" class="container-box"></div>

        <div class="instructions">
            <span class="label">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ:</span>
            <ul id="instructionList"></ul>
        </div>
    </div>

    <button onclick="location.href='camera.html'">–°–¥–µ–ª–∞—Ç—å –Ω–æ–≤–æ–µ —Ñ–æ—Ç–æ</button>


<script>

// ---- –û–î–ò–ù –≠–ú–û–î–ó–ò (—Å—Ç—Ä–æ–≥–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è) ----
function getContainerEmoji(text) {
    if (!text) return "‚ùì";
    text = text.toLowerCase();

    if (text.includes("–∂—ë–ª—Ç") || text.includes("–∂–µ–ª—Ç")) return "üü°";
    if (text.includes("—Å–∏–Ω")) return "üîµ";
    if (text.includes("–∑–µ–ª")) return "üü¢";
    if (text.includes("–º–µ—Ç–∞–ª–ª")) return "‚ö™";
    if (text.includes("–Ω–µ—Å–æ—Ä—Ç")) return "‚ö´";

    return "‚ùì";
}

// --- –ü–æ–ª—É—á–∞–µ–º JSON –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ ---
let raw = localStorage.getItem("waste_json");
let parsed = null;

try {
    parsed = JSON.parse(raw);
} catch (e) {
    document.getElementById("errorBlock").textContent =
        "–û—à–∏–±–∫–∞: —Å–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π JSON";
    document.getElementById("errorBlock").style.display = "block";
}

// --- –ï—Å–ª–∏ JSON –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π ---
if (parsed) {
    document.getElementById("resultCard").style.display = "block";

    // –ü—Ä–µ–¥–º–µ—Ç (–í–ê–ñ–ù–û: —Ç–µ–ø–µ—Ä—å parsed.item)
    document.getElementById("objectText").textContent =
        parsed.item || "–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å";

    // –ú–∞—Ç–µ—Ä–∏–∞–ª
    document.getElementById("materialText").textContent =
        parsed.material || "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ";

    // –£–±–∏—Ä–∞–µ–º —ç–º–æ–¥–∑–∏ –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (GPT –∏–Ω–æ–≥–¥–∞ –ø—Ä–∏—Å—ã–ª–∞–µ—Ç —Å–≤–æ–∏)
    let container = parsed.container || "–Ω–µ —É–∫–∞–∑–∞–Ω";
    container = container.replace(/[\p{Extended_Pictographic}]/gu, "").trim();

    // –≠–º–æ–¥–∑–∏ –≤—Å–µ–≥–¥–∞ –æ–¥–∏–Ω
    document.getElementById("containerBox").textContent =
        "–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä: " + getContainerEmoji(container) + " " + container;

    // –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
    const list = document.getElementById("instructionList");
    list.innerHTML = "";

    if (Array.isArray(parsed.instructions) && parsed.instructions.length > 0) {
        parsed.instructions.forEach(instr => {
            let li = document.createElement("li");
            li.textContent = instr;
            list.appendChild(li);
        });
    } else {
        let li = document.createElement("li");
        li.textContent = "–ù–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π";
        list.appendChild(li);
    }
}

</script>

</body>
</html>
